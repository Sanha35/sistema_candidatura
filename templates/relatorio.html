<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Relat√≥rio - Sistema de Registo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body { 
            background: #f8f9fa; 
            padding: 20px; 
            font-family: 'Poppins', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        main {
            flex: 1;
        }

        h2 { 
            color: #0d6efd; 
            font-weight: 600;
        }

        table img { 
            max-width: 50px; 
            max-height: 50px; 
            border-radius: 8px;
        }

        nav a { 
            margin-right: 15px; 
        }

        footer {
            background: #0d6efd;
            color: #fff;
            text-align: center;
            padding: 12px 0;
            font-size: 14px;
            font-weight: 500;
            letter-spacing: 0.5px;
            margin-top: 20px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.15);
        }

        footer a {
            color: #ffdd57;
            margin: 0 8px;
            text-decoration: none;
            font-size: 18px;
            transition: 0.3s;
        }

        footer a:hover {
            color: #fff;
            transform: scale(1.1);
        }

        footer strong {
            color: #ffdd57;
        }

        @media print {
            footer {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                font-size: 12px;
                background: #fff;
                color: #000;
                box-shadow: none;
                border-top: 1px solid #ccc;
            }

            footer a {
                color: #000 !important;
            }
        }
    </style>
</head>
<body>

<nav class="mb-3">
    <a href="{{ url_for('candidatura') }}" class="btn btn-secondary">Candidatura</a>
    <a href="{{ url_for('matricula') }}" class="btn btn-primary">Matr√≠cula</a>
    <a href="{{ url_for('relatorio') }}" class="btn btn-info text-white">Relat√≥rio</a>
    <a href="{{ url_for('logout') }}" class="btn btn-danger float-end">Sair</a>
</nav>

<main class="container">
    <h2>Relat√≥rio de Candidaturas</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('gerar_pdf') }}">
        <button type="submit" class="btn btn-success mb-3">Gerar PDF com Fotos</button>
    </form>

    <div class="table-responsive">
        <table class="table table-striped table-hover align-middle">
            <thead class="table-primary">
                <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Passaporte</th>
                    <th>Email</th>
                    <th>WhatsApp</th>
                    <th>Sexo</th>
                    <th>Curso</th>
                    <th>1¬™ Presta√ß√£o (‚Ç¨)</th>
                    <th>2¬™ Presta√ß√£o (‚Ç¨)</th>
                    <th>3¬™ Presta√ß√£o (‚Ç¨)</th>
                    <th>Total (‚Ç¨)</th>
                    <th>Resultado</th>
                    <th>Matr√≠cula</th>
                    <th>Foto</th>
                </tr>
            </thead>
            <tbody>
                {% for r in registros %}
                <tr>
                    <td>{{ r[0] }}</td>
                    <td>{{ r[1] }}</td>
                    <td>{{ r[2] }}</td>
                    <td>{{ r[4] }}</td>
                    <td>{{ r[5] }}</td>
                    <td>{{ r[6] }}</td>
                    <td>{{ r[11] }}</td>
                    <td>{{ "%.2f"|format(r[13] or 0) }}</td>
                    <td>{{ "%.2f"|format(r[14] or 0) }}</td>
                    <td>{{ "%.2f"|format(r[15] or 0) }}</td>
                    <td>{{ "%.2f"|format((r[13] or 0) + (r[14] or 0) + (r[15] or 0)) }}</td>
                    <td>{{ r[17] }}</td>
                    <td>{{ r[18] }}</td>
                    <td>
                        {% if r[12] %}
                        <img src="{{ url_for('static', filename='uploads/' ~ r[12]) }}" alt="Foto">
                        {% else %}
                        Sem Foto
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</main>

<footer>
    üßë‚Äçüíª Desenvolvido por <strong>Malam Sanh√°</strong> ¬© 2025 
    |
    <a href="https://www.linkedin.com/in/malam-sanha" target="_blank" title="LinkedIn">
        <i class="bi bi-linkedin"></i>
    </a>
    <a href="https://www.instagram.com/malamsanha2016" target="_blank" title="Instagram">
        <i class="bi bi-instagram"></i>
    </a>
</footer>

</body>
</html>
